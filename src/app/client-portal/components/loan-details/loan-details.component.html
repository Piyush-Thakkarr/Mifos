<div class="loan-details-page">
  <div class="page-header">
    <div>
      <h1>Loan Details</h1>
      <p class="subtitle" *ngIf="loan">{{ loan?.productName || loan?.loanProductName || 'Loan Account' }}</p>
    </div>
    <a [routerLink]="['../../loans']" class="btn btn-outline">
      <i class="fa fa-arrow-left"></i> Back to Loans
    </a>
  </div>

  <div *ngIf="loading" class="loading-state">
    <i class="fa fa-spinner fa-spin"></i>
    <p>Loading loan details...</p>
  </div>

  <div *ngIf="error" class="error-state">
    <i class="fa fa-exclamation-triangle"></i>
    <h3>Unable to Load Loan Details</h3>
    <p>{{ error }}</p>
  </div>

  <div *ngIf="loan && !loading" class="loan-content">
    <!-- Status Banner -->
    <div class="status-banner" [ngClass]="loan?.status?.code">
      <div class="status-info">
        <span class="status-label">Status</span>
        <span class="status-value">{{ loan?.status?.value }}</span>
      </div>
      <div class="account-info">
        <span class="label">Account No.</span>
        <span class="value">{{ loan?.accountNo }}</span>
      </div>
    </div>

    <!-- Summary Cards -->
    <div class="summary-grid">
      <div class="summary-card">
        <div class="icon-box blue">
          <i class="fa fa-money"></i>
        </div>
        <div class="summary-details">
          <span class="label">Principal Amount</span>
          <span class="value">{{ formatAmount(loan?.principal) }}</span>
        </div>
      </div>

      <div class="summary-card">
        <div class="icon-box red">
          <i class="fa fa-exclamation-circle"></i>
        </div>
        <div class="summary-details">
          <span class="label">Outstanding</span>
          <span class="value">{{ formatAmount(loan?.summary?.totalOutstanding) }}</span>
        </div>
      </div>

      <div class="summary-card">
        <div class="icon-box orange">
          <i class="fa fa-percent"></i>
        </div>
        <div class="summary-details">
          <span class="label">Interest Charged</span>
          <span class="value">{{ formatAmount(loan?.summary?.totalInterestCharged) }}</span>
        </div>
      </div>

      <div class="summary-card">
        <div class="icon-box green">
          <i class="fa fa-check-circle"></i>
        </div>
        <div class="summary-details">
          <span class="label">Amount Paid</span>
          <span class="value">{{ formatAmount(loan?.summary?.totalRepayment) }}</span>
        </div>
      </div>
    </div>

    <!-- Loan Information -->
    <div class="info-section">
      <h2>Loan Information</h2>
      <div class="info-grid">
        <div class="info-item">
          <span class="label">Loan ID</span>
          <span class="value">{{ loan?.id }}</span>
        </div>
        <div class="info-item">
          <span class="label">Account Number</span>
          <span class="value">{{ loan?.accountNo }}</span>
        </div>
        <div class="info-item">
          <span class="label">Disbursement Date</span>
          <span class="value">{{ formatDate(loan?.timeline?.actualDisbursementDate) || 'N/A' }}</span>
        </div>
        <div class="info-item">
          <span class="label">Maturity Date</span>
          <span class="value">{{ formatDate(loan?.timeline?.expectedMaturityDate) || 'N/A' }}</span>
        </div>
        <div class="info-item" *ngIf="loan?.clientName">
          <span class="label">Client Name</span>
          <span class="value">{{ loan?.clientName }}</span>
        </div>
        <div class="info-item">
          <span class="label">Loan Product</span>
          <span class="value">{{ loan?.productName || loan?.loanProductName || 'N/A' }}</span>
        </div>
      </div>
    </div>

    <!-- Quick Actions -->
    <div class="actions-section">
      <h2>Quick Actions</h2>
      <div class="actions-grid">
        <a [routerLink]="['repayments']" class="action-card">
          <i class="fa fa-calendar"></i>
          <h3>Repayment Schedule</h3>
          <p>View your payment schedule</p>
        </a>
        <a [routerLink]="['transactions']" class="action-card">
          <i class="fa fa-exchange"></i>
          <h3>Transactions</h3>
          <p>View transaction history</p>
        </a>
        <button class="action-card" *ngIf="loan?.status?.active">
          <i class="fa fa-credit-card"></i>
          <h3>Make Payment</h3>
          <p>Pay your EMI now</p>
        </button>
      </div>
    </div>
  </div>
</div>